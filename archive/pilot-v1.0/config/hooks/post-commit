#!/bin/bash

# Post-commit hook: AutomatickÃ½ push na GitHub po commite
# Tento hook sa automaticky spustÃ­ po kaÅ¾dom git commit
#
# InÅ¡talÃ¡cia:
#   cp xvadur/config/hooks/post-commit .git/hooks/post-commit
#   chmod +x .git/hooks/post-commit

# NaÄÃ­tanie git konfigurÃ¡cie
REMOTE=$(git config --get remote.origin.url)
BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Kontrola, Äi existuje remote
if [ -z "$REMOTE" ]; then
    echo "âš ï¸  Å½iadny remote origin nastavenÃ½. PreskoÄenie pushu."
    exit 0
fi

# Kontrola, Äi existuje branch tracking
REMOTE_BRANCH=$(git config --get branch.$BRANCH.remote)
if [ -z "$REMOTE_BRANCH" ]; then
    echo "âš ï¸  Branch '$BRANCH' nemÃ¡ nastavenÃ½ remote tracking. Push sa preskoÄÃ­."
    exit 0
fi

echo "ğŸš€ AutomatickÃ½ push na GitHub..."
echo "ğŸ“ Remote: $REMOTE"
echo "ğŸŒ¿ Branch: $BRANCH"

# Push na GitHub
if git push origin "$BRANCH" 2>&1; then
    echo "âœ… Push ÃºspeÅ¡nÃ½!"
    echo ""
    echo "ğŸ“Š PoslednÃ½ commit:"
    git log -1 --oneline
    echo ""
else
    echo "âŒ Push zlyhal. Skontroluj pripojenie alebo spusti manuÃ¡lne:"
    echo "   git push origin $BRANCH"
    exit 1
fi

